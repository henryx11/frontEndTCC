<div class="container">
  <div class="header">
    <h2>CartÃµes:</h2>
    <button class="btn-reload" (click)="recarregarDados()" [disabled]="loading">
      <span *ngIf="loading">ðŸ”„</span>
      <span *ngIf="!loading">â†»</span>
      {{ loading ? 'Carregando...' : 'Atualizar' }}
    </button>
  </div>

  <div class="cards" *ngIf="!loading">
    <div class="card"
         *ngFor="let cartao of cartoes"
         (click)="selecionarCartao(cartao.id)"
         [class.selected]="cartaoSelecionado === cartao.id">
      <div class="card-content">
        <h4>{{ cartao.description }}</h4>
        <p class="card-bandeira">{{ cartao.flags.name | titlecase }}</p>
        <p class="card-limite">Limite: R$ {{ cartao.limite | number:'1.2-2' }}</p>
      </div>
    </div>
    <div class="card create-card" routerLink="/create-card">
      <div class="card-content">
        <span class="plus-icon">+</span>
        <span>Criar CartÃ£o</span>
      </div>
    </div>
  </div>

  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <p>Carregando cartÃµes...</p>
  </div>

  <!-- BalÃ£o da fatura que aparece quando um cartÃ£o Ã© selecionado -->
  <div class="fatura" *ngIf="cartaoSelecionado && getFaturaAtual()">
    <!-- Header da fatura com navegaÃ§Ã£o -->
    <div class="fatura-header">
      <button
        class="nav-arrow nav-arrow-left"
        (click)="faturaAnterior()"
        [disabled]="!podeVoltar()"
        [class.disabled]="!podeVoltar()">
        &#8249;
      </button>

      <div class="fatura-title">
        <h3>{{ getNomeCartao() }}</h3>
        <p class="fatura-periodo">{{ getMesAnoFatura() }}</p>
      </div>

      <button
        class="nav-arrow nav-arrow-right"
        (click)="proximaFatura()"
        [disabled]="!podeAvancar()"
        [class.disabled]="!podeAvancar()">
        &#8250;
      </button>
    </div>

    <!-- InformaÃ§Ãµes da fatura -->
    <div class="fatura-info">
      <div class="fatura-item">
        <span class="label">Valor da Fatura:</span>
        <span class="value" [class]="getStatusFatura().toLowerCase().replace(' ', '-')">
          {{ getFaturaValor() }}
        </span>
      </div>

      <div class="fatura-item">
        <span class="label">Data de Vencimento:</span>
        <span class="value">{{ getDataVencimento() }}</span>
      </div>

      <div class="fatura-item">
        <span class="label">Limite DisponÃ­vel:</span>
        <span class="value limite">{{ getLimiteDisponivel() }}</span>
      </div>

      <div class="fatura-item">
        <span class="label">Status:</span>
        <span class="value status" [class]="getStatusFatura().toLowerCase().replace(' ', '-')">
          {{ getStatusFatura() }}
        </span>
      </div>
    </div>

    <!-- Indicador de navegaÃ§Ã£o (pontos) -->
    <div class="fatura-indicator" *ngIf="getCartaoSelecionado()">
      <span
        *ngFor="let fatura of getCartaoSelecionado()!.faturas; let i = index"
        class="indicator-dot"
        [class.active]="i === faturaAtualIndex"
        (click)="faturaAtualIndex = i">
      </span>
    </div>

    <!-- AÃ§Ãµes da fatura -->
    <div class="fatura-actions">
      <button
        class="btn-pagar">
      </button>

      <button class="btn-detalhes">
        Ver Detalhes
      </button>

      <button class="btn-fechar" (click)="fecharFatura()">
        âœ•
      </button>
    </div>
  </div>
</div>
