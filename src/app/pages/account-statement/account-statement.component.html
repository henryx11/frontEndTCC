<div class="container">
  <div class="header">
    <button class="btn-back" (click)="voltar()">
      ← Voltar
    </button>
    <h2>Extrato da Conta</h2>
    <div class="header-actions">
      <button class="btn-reload" (click)="carregarExtrato()" [disabled]="loading">
        <span *ngIf="loading">🔄</span>
        <span *ngIf="!loading">↻</span>
      </button>
    </div>
  </div>

  <!-- Resumo -->
  <div class="resumo">
    <div class="resumo-card receitas">
      <span class="resumo-label">💰 Entradas</span>
      <span class="resumo-value">+ R$ {{ getTotalReceitas() | number:'1.2-2' }}</span>
      <span class="resumo-subtitle">Receitas + Transferências Recebidas</span>
    </div>
    <div class="resumo-card despesas">
      <span class="resumo-label">💸 Saídas</span>
      <span class="resumo-value">- R$ {{ getTotalDespesas() | number:'1.2-2' }}</span>
      <span class="resumo-subtitle">Despesas + Transferências Enviadas</span>
    </div>
    <div class="resumo-card saldo">
      <span class="resumo-label">📊 Saldo Líquido</span>
      <span class="resumo-value" [class.negative]="getSaldo() < 0">
        R$ {{ getSaldo() | number:'1.2-2' }}
      </span>
      <span class="resumo-subtitle">Resultado do Período</span>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading-state" *ngIf="loading">
    <div class="spinner"></div>
    <p>Carregando extrato...</p>
  </div>

  <!-- Lista de transações -->
  <div class="transactions" *ngIf="!loading">
    <div class="transaction-item"
         *ngFor="let transaction of transactions"
         [ngClass]="getTransactionClass(transaction)">

      <div class="transaction-icon">
        <span class="icon-emoji">{{ transaction.icon }}</span>
      </div>

      <div class="transaction-info">
        <h4>{{ transaction.displayDescription }}</h4>
        <p class="transaction-category">
  <span class="transfer-badge" *ngIf="transaction.isTransfer">
    {{ transaction.type === 'TRANSFER_OUT' ? 'Transferência Enviada' : 'Transferência Recebida' }}
  </span>
          <span class="category-badge">
    {{ transaction.category.description }}
  </span>
        </p>


        <p class="transaction-date">
          📅 {{ transaction.registrationDate | date:'dd/MM/yyyy' }}
        </p>
        <p class="related-account" *ngIf="transaction.relatedAccountName">
          🏦 {{ transaction.relatedAccountName }}
        </p>
      </div>

      <div class="transaction-value" [class.positive]="isPositive(transaction.displayValue)">
        <span class="value-sign">{{ isPositive(transaction.displayValue) ? '+' : '-' }}</span>
        <span class="value-amount">{{ formatCurrency(transaction.displayValue) }}</span>
      </div>
    </div>

    <div class="empty-state" *ngIf="transactions.length === 0">
      <div class="empty-icon">📋</div>
      <p>Nenhuma transação encontrada</p>
      <small>As transações desta conta aparecerão aqui</small>
    </div>
  </div>
</div>
